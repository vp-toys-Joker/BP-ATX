
AVRASM ver. 2.2.7  d:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\main.asm Fri Dec 06 15:53:33 2019

[builtin](2): Including file 'C:/Program Files (x86)\Atmel\Studio\7.0\Packs\atmel\ATtiny_DFP\1.3.229\avrasm\inc\tn13adef.inc'
d:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\main.asm(61): Including file 'd:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\macros.inc'
d:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\main.asm(62): Including file 'd:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\constants_time.inc'
d:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\main.asm(63): Including file 'd:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\var-offonctrl.inc'
d:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\main.asm(82): Including file 'd:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\calls.asm'
[builtin](2): Including file 'C:/Program Files (x86)\Atmel\Studio\7.0\Packs\atmel\ATtiny_DFP\1.3.229\avrasm\inc\tn13adef.inc'
d:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\main.asm(61): Including file 'd:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\macros.inc'
d:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\main.asm(62): Including file 'd:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\constants_time.inc'
d:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\main.asm(63): Including file 'd:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\var-offonctrl.inc'
d:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\main.asm(82): Including file 'd:\Projects\AtmelStudio\OnOffCtrl-03\OnOffCtrl\calls.asm'
                                 
                                 ;
                                 
                                 ;***** Created: 2011-02-09 12:03 ******* Source: ATtiny13A.xml ***********
                                 ;*************************************************************************
                                 ;* A P P L I C A T I O N   N O T E   F O R   T H E   A V R   F A M I L Y
                                 ;* 
                                 ;* Number            : AVR000
                                 ;* File Name         : "tn13Adef.inc"
                                 ;* Title             : Register/Bit Definitions for the ATtiny13A
                                 ;* Date              : 2011-02-09
                                 ;* Version           : 2.35
                                 ;* Support E-mail    : avr@atmel.com
                                 ;* Target MCU        : ATtiny13A
                                 ;* 
                                 ;* DESCRIPTION
                                 ;* When including this file in the assembly program file, all I/O register 
                                 ;* names and I/O register bit names appearing in the data book can be used.
                                 ;* In addition, the six registers forming the three data pointers X, Y and 
                                 ;* Z have been assigned names XL - ZH. Highest RAM address for Internal 
                                 ;* SRAM is also defined 
                                 ;* 
                                 ;* The Register names are represented by their hexadecimal address.
                                 ;* 
                                 ;* The Register Bit names are represented by their bit number (0-7).
                                 ;* 
                                 ;* Please observe the difference in using the bit names with instructions
                                 ;* such as "sbr"/"cbr" (set/clear bit in register) and "sbrs"/"sbrc"
                                 ;* (skip if bit in register set/cleared). The following example illustrates
                                 ;* this:
                                 ;* 
                                 ;* in    r16,PORTB             ;read PORTB latch
                                 ;* sbr   r16,(1<<PB6)+(1<<PB5) ;set PB6 and PB5 (use masks, not bit#)
                                 ;* out   PORTB,r16             ;output to PORTB
                                 ;* 
                                 ;* in    r16,TIFR              ;read the Timer Interrupt Flag Register
                                 ;* sbrc  r16,TOV0              ;test the overflow flag (use bit#)
                                 ;* rjmp  TOV0_is_set           ;jump if set
                                 ;* ...                         ;otherwise do something else
                                 ;*************************************************************************
                                 
                                 #ifndef _TN13ADEF_INC_
                                 #define _TN13ADEF_INC_
                                 
                                 
                                 #pragma partinc 0
                                 
                                 ; ***** SPECIFY DEVICE ***************************************************
                                 .device ATtiny13A
                                 #pragma AVRPART ADMIN PART_NAME ATtiny13A
                                 .equ	SIGNATURE_000	= 0x1e
                                 .equ	SIGNATURE_001	= 0x90
                                 .equ	SIGNATURE_002	= 0x07
                                 
                                 #pragma AVRPART CORE CORE_VERSION V2
                                 #pragma AVRPART CORE NEW_INSTRUCTIONS lpm rd,z+
                                 
                                 
                                 ; ***** I/O REGISTER DEFINITIONS *****************************************
                                 ; NOTE:
                                 ; Definitions marked "MEMORY MAPPED"are extended I/O ports
                                 ; and cannot be used with IN/OUT instructions
                                 .equ	SREG	= 0x3f
                                 .equ	SPL	= 0x3d
                                 .equ	GIMSK	= 0x3b
                                 .equ	GIFR	= 0x3a
                                 .equ	TIMSK0	= 0x39
                                 .equ	TIFR0	= 0x38
                                 .equ	SPMCSR	= 0x37
                                 .equ	OCR0A	= 0x36
                                 .equ	MCUCR	= 0x35
                                 .equ	MCUSR	= 0x34
                                 .equ	TCCR0B	= 0x33
                                 .equ	TCNT0	= 0x32
                                 .equ	OSCCAL	= 0x31
                                 .equ	BODCR	= 0x30
                                 .equ	TCCR0A	= 0x2f
                                 .equ	DWDR	= 0x2e
                                 .equ	OCR0B	= 0x29
                                 .equ	GTCCR	= 0x28
                                 .equ	CLKPR	= 0x26
                                 .equ	PRR	= 0x25
                                 .equ	WDTCR	= 0x21
                                 .equ	EEAR	= 0x1e
                                 .equ	EEDR	= 0x1d
                                 .equ	EECR	= 0x1c
                                 .equ	PORTB	= 0x18
                                 .equ	DDRB	= 0x17
                                 .equ	PINB	= 0x16
                                 .equ	PCMSK	= 0x15
                                 .equ	DIDR0	= 0x14
                                 .equ	ACSR	= 0x08
                                 .equ	ADMUX	= 0x07
                                 .equ	ADCSRA	= 0x06
                                 .equ	ADCH	= 0x05
                                 .equ	ADCL	= 0x04
                                 .equ	ADCSRB	= 0x03
                                 
                                 
                                 ; ***** BIT DEFINITIONS **************************************************
                                 
                                 ; ***** AD_CONVERTER *****************
                                 ; ADMUX - The ADC multiplexer Selection Register
                                 .equ	MUX0	= 0	; Analog Channel and Gain Selection Bits
                                 .equ	MUX1	= 1	; Analog Channel and Gain Selection Bits
                                 .equ	ADLAR	= 5	; Left Adjust Result
                                 .equ	REFS0	= 6	; Reference Selection Bit 0
                                 
                                 ; ADCSRA - The ADC Control and Status register
                                 .equ	ADPS0	= 0	; ADC  Prescaler Select Bits
                                 .equ	ADPS1	= 1	; ADC  Prescaler Select Bits
                                 .equ	ADPS2	= 2	; ADC  Prescaler Select Bits
                                 .equ	ADIE	= 3	; ADC Interrupt Enable
                                 .equ	ADIF	= 4	; ADC Interrupt Flag
                                 .equ	ADATE	= 5	; ADC Auto Trigger Enable
                                 .equ	ADSC	= 6	; ADC Start Conversion
                                 .equ	ADEN	= 7	; ADC Enable
                                 
                                 ; ADCH - ADC Data Register High Byte
                                 .equ	ADCH0	= 0	; ADC Data Register High Byte Bit 0
                                 .equ	ADCH1	= 1	; ADC Data Register High Byte Bit 1
                                 .equ	ADCH2	= 2	; ADC Data Register High Byte Bit 2
                                 .equ	ADCH3	= 3	; ADC Data Register High Byte Bit 3
                                 .equ	ADCH4	= 4	; ADC Data Register High Byte Bit 4
                                 .equ	ADCH5	= 5	; ADC Data Register High Byte Bit 5
                                 .equ	ADCH6	= 6	; ADC Data Register High Byte Bit 6
                                 .equ	ADCH7	= 7	; ADC Data Register High Byte Bit 7
                                 
                                 ; ADCL - ADC Data Register Low Byte
                                 .equ	ADCL0	= 0	; ADC Data Register Low Byte Bit 0
                                 .equ	ADCL1	= 1	; ADC Data Register Low Byte Bit 1
                                 .equ	ADCL2	= 2	; ADC Data Register Low Byte Bit 2
                                 .equ	ADCL3	= 3	; ADC Data Register Low Byte Bit 3
                                 .equ	ADCL4	= 4	; ADC Data Register Low Byte Bit 4
                                 .equ	ADCL5	= 5	; ADC Data Register Low Byte Bit 5
                                 .equ	ADCL6	= 6	; ADC Data Register Low Byte Bit 6
                                 .equ	ADCL7	= 7	; ADC Data Register Low Byte Bit 7
                                 
                                 ; ADCSRB - ADC Control and Status Register B
                                 .equ	ADTS0	= 0	; ADC Auto Trigger Source 0
                                 .equ	ADTS1	= 1	; ADC Auto Trigger Source 1
                                 .equ	ADTS2	= 2	; ADC Auto Trigger Source 2
                                 
                                 ; DIDR0 - Digital Input Disable Register 0
                                 .equ	ADC1D	= 2	; ADC2 Digital input Disable
                                 .equ	ADC3D	= 3	; ADC3 Digital input Disable
                                 .equ	ADC2D	= 4	; ADC2 Digital input Disable
                                 .equ	ADC0D	= 5	; ADC0 Digital input Disable
                                 
                                 
                                 ; ***** ANALOG_COMPARATOR ************
                                 ; ADCSRB - ADC Control and Status Register B
                                 .equ	ACME	= 6	; Analog Comparator Multiplexer Enable
                                 
                                 ; ACSR - Analog Comparator Control And Status Register
                                 .equ	ACIS0	= 0	; Analog Comparator Interrupt Mode Select bit 0
                                 .equ	ACIS1	= 1	; Analog Comparator Interrupt Mode Select bit 1
                                 .equ	ACIE	= 3	; Analog Comparator Interrupt Enable
                                 .equ	ACI	= 4	; Analog Comparator Interrupt Flag
                                 .equ	ACO	= 5	; Analog Compare Output
                                 .equ	ACBG	= 6	; Analog Comparator Bandgap Select
                                 .equ	AINBG	= ACBG	; For compatibility
                                 .equ	ACD	= 7	; Analog Comparator Disable
                                 
                                 ; DIDR0 - 
                                 .equ	AIN0D	= 0	; AIN0 Digital Input Disable
                                 .equ	AIN1D	= 1	; AIN1 Digital Input Disable
                                 
                                 
                                 ; ***** EEPROM ***********************
                                 ; EEAR - EEPROM Read/Write Access
                                 .equ	EEARL	= EEAR	; For compatibility
                                 .equ	EEAR0	= 0	; EEPROM Read/Write Access bit 0
                                 .equ	EEAR1	= 1	; EEPROM Read/Write Access bit 1
                                 .equ	EEAR2	= 2	; EEPROM Read/Write Access bit 2
                                 .equ	EEAR3	= 3	; EEPROM Read/Write Access bit 3
                                 .equ	EEAR4	= 4	; EEPROM Read/Write Access bit 4
                                 .equ	EEAR5	= 5	; EEPROM Read/Write Access bit 5
                                 
                                 ; EEDR - EEPROM Data Register
                                 .equ	EEDR0	= 0	; EEPROM Data Register bit 0
                                 .equ	EEDR1	= 1	; EEPROM Data Register bit 1
                                 .equ	EEDR2	= 2	; EEPROM Data Register bit 2
                                 .equ	EEDR3	= 3	; EEPROM Data Register bit 3
                                 .equ	EEDR4	= 4	; EEPROM Data Register bit 4
                                 .equ	EEDR5	= 5	; EEPROM Data Register bit 5
                                 .equ	EEDR6	= 6	; EEPROM Data Register bit 6
                                 .equ	EEDR7	= 7	; EEPROM Data Register bit 7
                                 
                                 ; EECR - EEPROM Control Register
                                 .equ	EERE	= 0	; EEPROM Read Enable
                                 .equ	EEWE	= 1	; EEPROM Write Enable
                                 .equ	EEPE	= EEWE	; For compatibility
                                 .equ	EEMWE	= 2	; EEPROM Master Write Enable
                                 .equ	EEMPE	= EEMWE	; For compatibility
                                 .equ	EERIE	= 3	; EEProm Ready Interrupt Enable
                                 .equ	EEPM0	= 4	; 
                                 .equ	EEPM1	= 5	; 
                                 
                                 
                                 ; ***** PORTB ************************
                                 ; PORTB - Data Register, Port B
                                 .equ	PORTB0	= 0	; 
                                 .equ	PB0	= 0	; For compatibility
                                 .equ	PORTB1	= 1	; 
                                 .equ	PB1	= 1	; For compatibility
                                 .equ	PORTB2	= 2	; 
                                 .equ	PB2	= 2	; For compatibility
                                 .equ	PORTB3	= 3	; 
                                 .equ	PB3	= 3	; For compatibility
                                 .equ	PORTB4	= 4	; 
                                 .equ	PB4	= 4	; For compatibility
                                 .equ	PORTB5	= 5	; 
                                 .equ	PB5	= 5	; For compatibility
                                 
                                 ; DDRB - Data Direction Register, Port B
                                 .equ	DDB0	= 0	; 
                                 .equ	DDB1	= 1	; 
                                 .equ	DDB2	= 2	; 
                                 .equ	DDB3	= 3	; 
                                 .equ	DDB4	= 4	; 
                                 .equ	DDB5	= 5	; 
                                 
                                 ; PINB - Input Pins, Port B
                                 .equ	PINB0	= 0	; 
                                 .equ	PINB1	= 1	; 
                                 .equ	PINB2	= 2	; 
                                 .equ	PINB3	= 3	; 
                                 .equ	PINB4	= 4	; 
                                 .equ	PINB5	= 5	; 
                                 
                                 
                                 ; ***** EXTERNAL_INTERRUPT ***********
                                 ; MCUCR - MCU Control Register
                                 .equ	ISC00	= 0	; Interrupt Sense Control 0 Bit 0
                                 .equ	ISC01	= 1	; Interrupt Sense Control 0 Bit 1
                                 
                                 ; GIMSK - General Interrupt Mask Register
                                 .equ	GICR	= GIMSK	; For compatibility
                                 .equ	PCIE	= 5	; Pin Change Interrupt Enable
                                 .equ	INT0	= 6	; External Interrupt Request 0 Enable
                                 
                                 ; GIFR - General Interrupt Flag register
                                 .equ	PCIF	= 5	; Pin Change Interrupt Flag
                                 .equ	INTF0	= 6	; External Interrupt Flag 0
                                 
                                 ; PCMSK - Pin Change Enable Mask
                                 .equ	PCINT0	= 0	; Pin Change Enable Mask Bit 0
                                 .equ	PCINT1	= 1	; Pin Change Enable Mask Bit 1
                                 .equ	PCINT2	= 2	; Pin Change Enable Mask Bit 2
                                 .equ	PCINT3	= 3	; Pin Change Enable Mask Bit 3
                                 .equ	PCINT4	= 4	; Pin Change Enable Mask Bit 4
                                 .equ	PCINT5	= 5	; Pin Change Enable Mask Bit 5
                                 
                                 
                                 ; ***** TIMER_COUNTER_0 **************
                                 ; TIMSK0 - Timer/Counter0 Interrupt Mask Register
                                 .equ	TOIE0	= 1	; Timer/Counter0 Overflow Interrupt Enable
                                 .equ	OCIE0A	= 2	; Timer/Counter0 Output Compare Match A Interrupt Enable
                                 .equ	OCIE0B	= 3	; Timer/Counter0 Output Compare Match B Interrupt Enable
                                 
                                 ; TIFR0 - Timer/Counter0 Interrupt Flag register
                                 .equ	TOV0	= 1	; Timer/Counter0 Overflow Flag
                                 .equ	OCF0A	= 2	; Timer/Counter0 Output Compare Flag 0A
                                 .equ	OCF0B	= 3	; Timer/Counter0 Output Compare Flag 0B
                                 
                                 ; OCR0A - Timer/Counter0 Output Compare Register
                                 .equ	OCR0A_0	= 0	; 
                                 .equ	OCR0A_1	= 1	; 
                                 .equ	OCR0A_2	= 2	; 
                                 .equ	OCR0A_3	= 3	; 
                                 .equ	OCR0A_4	= 4	; 
                                 .equ	OCR0A_5	= 5	; 
                                 .equ	OCR0A_6	= 6	; 
                                 .equ	OCR0A_7	= 7	; 
                                 
                                 ; TCCR0A - Timer/Counter  Control Register A
                                 .equ	WGM00	= 0	; Waveform Generation Mode
                                 .equ	WGM01	= 1	; Waveform Generation Mode
                                 .equ	COM0B0	= 4	; Compare Match Output B Mode
                                 .equ	COM0B1	= 5	; Compare Match Output B Mode
                                 .equ	COM0A0	= 6	; Compare Match Output A Mode
                                 .equ	COM0A1	= 7	; Compare Match Output A Mode
                                 
                                 ; TCNT0 - Timer/Counter0
                                 .equ	TCNT0_0	= 0	; 
                                 .equ	TCNT0_1	= 1	; 
                                 .equ	TCNT0_2	= 2	; 
                                 .equ	TCNT0_3	= 3	; 
                                 .equ	TCNT0_4	= 4	; 
                                 .equ	TCNT0_5	= 5	; 
                                 .equ	TCNT0_6	= 6	; 
                                 .equ	TCNT0_7	= 7	; 
                                 
                                 ; TCCR0B - Timer/Counter Control Register B
                                 .equ	CS00	= 0	; Clock Select
                                 .equ	CS01	= 1	; Clock Select
                                 .equ	CS02	= 2	; Clock Select
                                 .equ	WGM02	= 3	; Waveform Generation Mode
                                 .equ	FOC0B	= 6	; Force Output Compare B
                                 .equ	FOC0A	= 7	; Force Output Compare A
                                 
                                 ; OCR0B - Timer/Counter0 Output Compare Register
                                 .equ	OCR0B_0	= 0	; 
                                 .equ	OCR0B_1	= 1	; 
                                 .equ	OCR0B_2	= 2	; 
                                 .equ	OCR0B_3	= 3	; 
                                 .equ	OCR0B_4	= 4	; 
                                 .equ	OCR0B_5	= 5	; 
                                 .equ	OCR0B_6	= 6	; 
                                 .equ	OCR0B_7	= 7	; 
                                 
                                 ; GTCCR - General Timer Conuter Register
                                 .equ	PSR10	= 0	; Prescaler Reset Timer/Counter0
                                 .equ	TSM	= 7	; Timer/Counter Synchronization Mode
                                 
                                 
                                 ; ***** WATCHDOG *********************
                                 ; WDTCR - Watchdog Timer Control Register
                                 .equ	WDP0	= 0	; Watch Dog Timer Prescaler bit 0
                                 .equ	WDP1	= 1	; Watch Dog Timer Prescaler bit 1
                                 .equ	WDP2	= 2	; Watch Dog Timer Prescaler bit 2
                                 .equ	WDE	= 3	; Watch Dog Enable
                                 .equ	WDCE	= 4	; Watchdog Change Enable
                                 .equ	WDP3	= 5	; Watchdog Timer Prescaler Bit 3
                                 .equ	WDTIE	= 6	; Watchdog Timeout Interrupt Enable
                                 .equ	WDTIF	= 7	; Watchdog Timeout Interrupt Flag
                                 
                                 
                                 ; ***** CPU **************************
                                 ; SREG - Status Register
                                 .equ	SREG_C	= 0	; Carry Flag
                                 .equ	SREG_Z	= 1	; Zero Flag
                                 .equ	SREG_N	= 2	; Negative Flag
                                 .equ	SREG_V	= 3	; Two's Complement Overflow Flag
                                 .equ	SREG_S	= 4	; Sign Bit
                                 .equ	SREG_H	= 5	; Half Carry Flag
                                 .equ	SREG_T	= 6	; Bit Copy Storage
                                 .equ	SREG_I	= 7	; Global Interrupt Enable
                                 
                                 ; SPL - Stack Pointer Low Byte
                                 .equ	SP0	= 0	; Stack Pointer Bit 0
                                 .equ	SP1	= 1	; Stack Pointer Bit 1
                                 .equ	SP2	= 2	; Stack Pointer Bit 2
                                 .equ	SP3	= 3	; Stack Pointer Bit 3
                                 .equ	SP4	= 4	; Stack Pointer Bit 4
                                 .equ	SP5	= 5	; Stack Pointer Bit 5
                                 .equ	SP6	= 6	; Stack Pointer Bit 6
                                 .equ	SP7	= 7	; Stack Pointer Bit 7
                                 
                                 ; MCUCR - MCU Control Register
                                 ;.equ	ISC00	= 0	; Interrupt Sense Control 0 bit 0
                                 ;.equ	ISC01	= 1	; Interrupt Sense Control 0 bit 1
                                 .equ	SM0	= 3	; Sleep Mode Select Bit 0
                                 .equ	SM1	= 4	; Sleep Mode Select Bit 1
                                 .equ	SE	= 5	; Sleep Enable
                                 .equ	PUD	= 6	; Pull-up Disable
                                 
                                 ; MCUSR - MCU Status register
                                 .equ	PORF	= 0	; Power-On Reset Flag
                                 .equ	EXTRF	= 1	; External Reset Flag
                                 .equ	BORF	= 2	; Brown-out Reset Flag
                                 .equ	WDRF	= 3	; Watchdog Reset Flag
                                 
                                 ; OSCCAL - Oscillator Calibration Register
                                 .equ	CAL0	= 0	; Oscillatro Calibration Value Bit 0
                                 .equ	CAL1	= 1	; Oscillatro Calibration Value Bit 1
                                 .equ	CAL2	= 2	; Oscillatro Calibration Value Bit 2
                                 .equ	CAL3	= 3	; Oscillatro Calibration Value Bit 3
                                 .equ	CAL4	= 4	; Oscillatro Calibration Value Bit 4
                                 .equ	CAL5	= 5	; Oscillatro Calibration Value Bit 5
                                 .equ	CAL6	= 6	; Oscillatro Calibration Value Bit 6
                                 
                                 ; CLKPR - Clock Prescale Register
                                 .equ	CLKPS0	= 0	; Clock Prescaler Select Bit 0
                                 .equ	CLKPS1	= 1	; Clock Prescaler Select Bit 1
                                 .equ	CLKPS2	= 2	; Clock Prescaler Select Bit 2
                                 .equ	CLKPS3	= 3	; Clock Prescaler Select Bit 3
                                 .equ	CLKPCE	= 7	; Clock Prescaler Change Enable
                                 
                                 ; DWDR - Debug Wire Data Register
                                 .equ	DWDR0	= 0	; Debug Wire Data Register Bit 0
                                 .equ	DWDR1	= 1	; Debug Wire Data Register Bit 1
                                 .equ	DWDR2	= 2	; Debug Wire Data Register Bit 2
                                 .equ	DWDR3	= 3	; Debug Wire Data Register Bit 3
                                 .equ	DWDR4	= 4	; Debug Wire Data Register Bit 4
                                 .equ	DWDR5	= 5	; Debug Wire Data Register Bit 5
                                 .equ	DWDR6	= 6	; Debug Wire Data Register Bit 6
                                 .equ	DWDR7	= 7	; Debug Wire Data Register Bit 7
                                 
                                 ; SPMCSR - Store Program Memory Control and Status Register
                                 .equ	SPMEN	= 0	; Store program Memory Enable
                                 .equ	PGERS	= 1	; Page Erase
                                 .equ	PGWRT	= 2	; Page Write
                                 .equ	RFLB	= 3	; Read Fuse and Lock Bits
                                 .equ	CTPB	= 4	; Clear Temporary Page Buffer
                                 
                                 ; PRR - Power Reduction Register
                                 .equ	PRADC	= 0	; Power Reduction ADC
                                 .equ	PRTIM0	= 1	; Power Reduction Timer/Counter0
                                 
                                 ; BODCR - BOD Control Register
                                 .equ	BPDSE	= 0	; BOD Power-Down Sleep Enable
                                 .equ	BPDS	= 1	; BOD Power-Down in Power-Down Sleep
                                 
                                 
                                 
                                 ; ***** LOCKSBITS ********************************************************
                                 .equ	LB1	= 0	; Lockbit
                                 .equ	LB2	= 1	; Lockbit
                                 
                                 
                                 ; ***** FUSES ************************************************************
                                 ; LOW fuse bits
                                 .equ	CKSEL0	= 0	; Select Clock Source
                                 .equ	CKSEL1	= 1	; Select Clock Source
                                 .equ	SUT0	= 2	; Select start-up time
                                 .equ	SUT1	= 3	; Select start-up time
                                 .equ	CKDIV8	= 4	; Start up with system clock divided by 8
                                 .equ	WDTON	= 5	; Watch dog timer always on
                                 .equ	EESAVE	= 6	; Keep EEprom contents during chip erase
                                 .equ	SPIEN	= 7	; SPI programming enable
                                 
                                 ; HIGH fuse bits
                                 .equ	RSTDISBL	= 0	; Disable external reset
                                 .equ	BODLEVEL0	= 1	; Enable BOD and select level
                                 .equ	BODLEVEL1	= 2	; Enable BOD and select level
                                 .equ	DWEN	= 3	; DebugWire Enable
                                 .equ	SELFPRGEN	= 4	; Self Programming Enable
                                 
                                 
                                 
                                 ; ***** CPU REGISTER DEFINITIONS *****************************************
                                 .def	XH	= r27
                                 .def	XL	= r26
                                 .def	YH	= r29
                                 .def	YL	= r28
                                 .def	ZH	= r31
                                 .def	ZL	= r30
                                 
                                 
                                 
                                 ; ***** DATA MEMORY DECLARATIONS *****************************************
                                 .equ	FLASHEND	= 0x01ff	; Note: Word address
                                 .equ	IOEND	= 0x003f
                                 .equ	SRAM_START	= 0x0060
                                 .equ	SRAM_SIZE	= 64
                                 .equ	RAMEND	= 0x009f
                                 .equ	XRAMEND	= 0x0000
                                 .equ	E2END	= 0x003f
                                 .equ	EEPROMEND	= 0x003f
                                 .equ	EEADRBITS	= 6
                                 #pragma AVRPART MEMORY PROG_FLASH 1024
                                 #pragma AVRPART MEMORY EEPROM 64
                                 #pragma AVRPART MEMORY INT_SRAM SIZE 64
                                 #pragma AVRPART MEMORY INT_SRAM START_ADDR 0x60
                                 
                                 
                                 
                                 ; ***** BOOTLOADER DECLARATIONS ******************************************
                                 .equ	PAGESIZE	= 16
                                 
                                 
                                 
                                 ; ***** INTERRUPT VECTORS ************************************************
                                 .equ	INT0addr	= 0x0001	; External Interrupt 0
                                 .equ	PCI0addr	= 0x0002	; External Interrupt Request 0
                                 .equ	OVF0addr	= 0x0003	; Timer/Counter0 Overflow
                                 .equ	ERDYaddr	= 0x0004	; EEPROM Ready
                                 .equ	ACIaddr	= 0x0005	; Analog Comparator
                                 .equ	OC0Aaddr	= 0x0006	; Timer/Counter Compare Match A
                                 .equ	OC0Baddr	= 0x0007	; Timer/Counter Compare Match B
                                 .equ	WDTaddr	= 0x0008	; Watchdog Time-out
                                 .equ	ADCCaddr	= 0x0009	; ADC Conversion Complete
                                 
                                 .equ	INT_VECTORS_SIZE	= 10	; size in words
                                 
                                 #endif  /* _TN13ADEF_INC_ */
                                 
                                 ; ***** END OF FILE ******************************************************
                                 
                                 ; OnOffCtrl.asm
                                 ; version 0.31  
                                 ;переработан обработчик нажатия кнопки:
                                 ; весь обработчик размещен в прерывании _int0
                                 ; звуковой сигнал подается при нажатии на кнопку, а не при отпускании.
                                 ; v0.1: 08.10.2019
                                 ; v0.2: 16.11.2019
                                 ; v0.31: 06.12.2019
                                 ; Author : vp
                                 ;
                                 ;====================================================================
                                 ;====================================================================
                                 ;                       DEFINITIONS
                                 ;====================================================================
                                 ;.set _DEBUG_ = 1
                                 .def fdel = r0  ;1 - флаг четного прерывания или делителя частоты: 0 - четный (пропуск счета); 1 - нечетный (счет)
                                 ;==============================================================================================
                                 ;                               Состояния и режимы
                                 ;==============================================================================================
                                 ;====================================================================
                                 ; state |                       0 - отключен                        |
                                 ;====================================================================
                                 ; mode  | Готовность | Ожидание включения | Индикация неисправности |
                                 ;       |  Ожидание  | (появление напряже-| (БП не запустился или   |
                                 ;       |  кнопки    |  ния)              | самопроизвольно отключ. |
                                 ;       |============================================================
                                 ;       |     0      |         1          |          2              |
                                 ;====================================================================
                                 ; state |                       1 - включен                         |
                                 ;====================================================================
                                 ; mode  | Готовность | Ожидание отключения| Индикация неисправности |
                                 ;       | Ожидание   |(пропадание напряже-| (БП не отключился)      |
                                 ;       | кнопки     | ния)               |                         |
                                 ;       |============================================================
                                 ;       |    0       |         1          |          2              |
                                 ;====================================================================
                                 .def state = r1      ; состояние: 0 - отключен; 1 - включен
                                 .def mode = r2       ; режим состояния
                                 .def button_event = r3    ; событие нажатия кнопки: 0 - нет события; 1 - была нажата или отжата.
                                 .def key_state = r4 ; состояние обработчика нажатия кнопки: 
                                                      ;     0 - ожидание: начальное значение - устанавл. обработчик key_process
                                                      ;     1 - событие обработчика прерывания - произошло изменение входа INT0 - начало обработки дребезга контактов
                                                      ;     2 - событие обработчика прерывания - обработка дребезга контактов и определение состояния кнопки
                                                      ;         устанавл. обработчик key_process
                                 .def pwr_ok_event = r5; событие изменения состояния контрольного сигнала PW_OK
                                                      ;     0 - ожидание: нет события;
                                                      ;     1 - событие - состояние изменилось
                                 .def pwr_ok_state = r6; состояние входа контрольного сигнала PW_OK
                                                      ;     0 - нет напряжения;
                                                      ;     1 - есть напряжение
                                 .def const_0 = r7    ; регистр должен быть равен 0
                                 .def const_1 = r8    ; регистр должен быть равен 1
                                 .def const_2 = r9    ; регистр должен быть равен 2
                                 .def button_state = r10  ; состояние кнопки: 0 - нажата; 1 - отжата.
                                 
                                 .def temp1 = r16
                                 .def temp2 = r17
                                 .def temp3 = r18
                                 
                                 .INCLUDE "macros.inc"
                                 
                                  * macros.asm
                                  *
                                  *  Created: 30.10.2019 13:35:50
                                  *   Author: vp
                                  */ 
                                 ;==================================================================
                                 ;                   макрос _SET_TIMER_
                                 ;==================================================================
                                 ;   Задает время исполнения указанному таймеру
                                 ; с возможностью отложенного или немедленного исполнения таймера.
                                 ; при условии заданному разрешению прерывания от переполнения TCNT0
                                 ; и общему разрешению прерываний
                                 ;==================================================================
                                 .MACRO _SET_TIMER_ 
                                 ; Описание параметров макроса
                                 ;@0 - имя структуры таймера (например - timer01), 
                                 ;@1 - имя константы времени работы таймера (например - key_snd_time), 
                                 ;@2 - регистр РОН указатель на @0 (например - X), 
                                 ;@3 регистр РОН мл. байта @1 (например - r16 = temp1),  
                                 ;@4 регистр РОН ст. байта @1 (например - r17 = temp2),  
                                 ;@5 регистр РОН управления (например - r18 == 0 или != 0 : = temp3): 
                                 ;   == 0 - запрет немедленного выполнения таймера; 
                                 ;   != 0 - немедленный запуск таймера с новыми параметрами
                                 ;==================================================================
                                     ldi @2L, LOW(@0)  ; указать адрес в области таймеров на требуемый таймер
                                     ldi @3, LOW(@1)   ; загрузить мл. байт константы параметра таймера
                                     ldi @4, HIGH(@1)  ; загрузить ст. байт константы параметра таймера
                                     tst @5
                                     brne PC+7     ;brne _set_timer_start
                                     ;=====================================================
                                     ;   иницирование нового таймера со сбросом старого 
                                     ;=====================================================
                                     cli
                                     st @2+, @5    ; обнулить флаг таймера - запрет немедленного выполнения таймера
                                     st @2+, @3    ; инициализировать мл. байт значения таймера
                                     st @2,  @4     ; инициализировать ст. байт значения таймера
                                     sei
                                     rjmp PC+7     ;rjmp _set_timer_return
                                     ;=====================================================
                                     ;           иницирование нового таймера 
                                     ;        вместо уже отработавшего старого 
                                     ;=====================================================
                                 ;_set_timer_start:
                                     adiw @2, 3
                                     cli
                                     st -@2, @4    ; инициализировать ст. байт значения таймера 
                                     st -@2, @3    ; инициализировать мл. байт значения таймера 
                                     st -@2, @5    ; установить флаг таймера - немедленный запуск таймера с новыми параметрами
                                     sei
                                 ;_set_timer_return:
                                 .ENDMACRO
                                 
                                 ;==================================================================
                                 ;                   макрос _OCR0B_On_
                                 ;==================================================================
                                 ;  подключение OCR0A к выводу
                                 ;==================================================================
                                 ; Описание параметров макроса
                                 ; @0 - регистр РОН оператор регистра tccr0a  (например r16 = temp1)
                                 ; @1 - регистр РОН содержащий бит флага tccr0a, 
                                 ;      подключающий OCR0B к выводу  (например r17 = temp2)
                                 ;==================================================================
                                 .MACRO  _OCR0A_On_
                                 	in  @0, tccr0a
                                 	ldi @1, 0x40
                                 	or @0, @1		; подключить OCR0A к выводу
                                 	out tccr0a, @0	; OCR0B подключен к выводу
                                 .ENDMACRO
                                 
                                 ;==================================================================
                                 ;                   макрос _OCR0A_Off_
                                 ;==================================================================
                                 ;  отключение OCR0B от вывода
                                 ;==================================================================
                                 ; Описание параметров макроса
                                 ; @0 - регистр РОН оператор регистра tccr0a  (например r16 = temp1)
                                 ; @1 - регистр РОН содержащий бит флага tccr0a, 
                                 ;      отключающий OCR0B к выводу  (например r17 = temp2)
                                 ;==================================================================
                                 .MACRO  _OCR0A_Off_
                                 	in  @0, tccr0a
                                 	ldi @1, 0xbf
                                 	and @0, @1		; отключить OCR0A от вывода
                                 	out tccr0a, @0	; OCR0B подключен к выводу
                                 .ENDMACRO
                                 
                                 ;==================================================================
                                 ;                   макрос _OCR0B_On_
                                 ;==================================================================
                                 ;  подключение OCR0B к выводу
                                 ;==================================================================
                                 ; Описание параметров макроса
                                 ; @0 - регистр РОН оператор регистра tccr0a  (например r16 = temp1)
                                 ; @1 - регистр РОН содержащий бит флага tccr0a, 
                                 ;      подключающий OCR0B к выводу  (например r17 = temp2)
                                 ;==================================================================
                                 .MACRO  _OCR0B_On_
                                 	in  @0, tccr0a
                                 	ldi @1, 0x10
                                 	or @0, @1		; подключить OCR0B к выводу
                                 	out tccr0a, @0	; OCR0B подключен к выводу
                                 .ENDMACRO
                                 
                                 ;==================================================================
                                 ;                   макрос _OCR0B_Off_
                                 ;==================================================================
                                 ;  отключение OCR0B от вывода
                                 ;==================================================================
                                 ; Описание параметров макроса
                                 ; @0 - регистр РОН оператор регистра tccr0a  (например r16 = temp1)
                                 ; @1 - регистр РОН содержащий бит флага tccr0a, 
                                 ;      отключающий OCR0B к выводу  (например r17 = temp2)
                                 ;==================================================================
                                 .MACRO  _OCR0B_Off_
                                 	in  @0, tccr0a
                                 	ldi @1, 0xef
                                 	and @0, @1		; отключить OCR0B от вывода
                                 	out tccr0a, @0	; OCR0B подключен к выводу
                                 .ENDMACRO
                                 
                                 ;==================================================================
                                 ;                   макрос _MODE_INT0_
                                 ;==================================================================
                                 ;   задается разрешение от внешнего прерывания INT0
                                 ;==================================================================
                                 ; Описание параметров макроса
                                 ; @0 - регистр РОН (например r16  = temp1)
                                 ; @1 - регистр РОН оператор регистра mcucr (например r17 =  = temp2)
                                 ; @2 - номер режима INT0:
                                 ;      0 - по низкому уровню
                                 ;      1 - при любом изменении
                                 ;      2 - при спаде
                                 ;      3 - при фронте
                                 ;==================================================================
                                 .MACRO _MODE_INT0_
                                     ldi @0, @2        ; @2 - режим прерывания от INT0 по нарастающему фронту
                                     in @1, mcucr
                                     or @1, @0
                                     out mcucr, @1     ; устанавливается режим от внешнего прерывания INT0
                                 .ENDMACRO
                                 
                                 ;==================================================================
                                 ;                   макрос _SET_NUM_PCIE_
                                 ;=====================================================
                                 ;   задается номер прерывания PCIE
                                 ;=====================================================
                                 ; Описание параметров макроса
                                 ; @0 - регистр РОН (например r16  = temp1)
                                 ; @1 - регистр РОН оператор регистра pcmsk (например r17  = temp2)
                                 ; @2 - номер PCIE:
                                 ;      1 - PCI0
                                 ;      2 - PCI1
                                 ;      4 - PCI2
                                 ;      8 - PCI3
                                 ;   0x10 - PCI4
                                 ;   0x20 - PCI5
                                 ;==================================================================
                                 .MACRO _SET_NUM_PCIE_
                                     ldi @0, @2        ; @2 - задается номер прерывания PCINT
                                     in @1, pcmsk
                                     or @1, @0
                                     out pcmsk, @1     ; устанавливается номер прерывания PCINT
                                 .ENDMACRO
                                 
                                 ;==================================================================
                                 ;                   макрос _EN_EXTINT_
                                 ;==================================================================
                                 ;   задается разрешение от внешнего прерывания INT0
                                 ;==================================================================
                                 ; Описание параметров макроса
                                 ; @0 - регистр РОН (например r16  = temp1)
                                 ; @1 - регистр РОН оператор регистра gimsk (например r17  = temp2)
                                 ; @2 - флаги разрешенных прерываний:
                                 ;       0x20 - PCIE
                                 ;       0x40 - INT0
                                 ;       0x60 - оба
                                 ;==================================================================
                                 .MACRO _EN_EXTINT_
                                     ldi @0, @2        ; @2 биты прерываний разрешенных от ЕХТINT
                                     in @1, gimsk
                                     or @1, @0
                                     out gimsk, @1     ; устанавливается разрешение от внешнего прерывания INT0
                                     in @1, gifr
                                     eor @1, @0
                                     out gifr, @1      ; сброс флагов прерываний установленных ранее   
                                 .ENDMACRO
                                 
                                 
                                 ;==================================================================
                                 ;                   макрос _DIS_EXTINT_
                                 ;==================================================================
                                 ;   задается запрет от внешнего прерывания INT0
                                 ;==================================================================
                                 ; Описание параметров макроса
                                 ; @0 - регистр РОН (например r16 = temp1)
                                 ; @1 - регистр РОН оператор регистра gimsk (например r17 = temp2)
                                 ; @2 - флаги запрешенных прерываний:
                                 ;       0x20 - PCIE
                                 ;       0x40 - INT0
                                 ;       0x60 - оба
                                 ;==================================================================
                                 .MACRO _DIS_EXTINT_
                                     ldi @0, @2        ; @2 биты прерываний разрешенных от ЕХТINT
                                     in @1, gimsk
                                     eor @1, @0
                                     out gimsk, @1     ; устанавливается разрешение от внешнего прерывания INT0
                                 .ENDMACRO
                                 .INCLUDE "constants_time.inc"
                                 
                                  * constants_time.asm
                                  *
                                  *  Created: 30.10.2019 13:46:15
                                  *   Author: vp
                                  */ 
                                 ;====================================================================
                                 ;                       CONSTANTS
                                 ;====================================================================
                                 .CSEG
                                 ;частота TCNT0 = 2.34 - 2.48, а с учетом программного делителя fdel = 2,
                                 ; Ftimer = 1.17 - 1.24 кГц => параметры времени программных таймеров необходимо увеличить, примерно, на 1.24.
                                 .equ key_snd_time = 124 ;= 100 msec - время звукового импульса нажатия кнопки
                                 .equ err_snd_time = 1240 ;= 1000 msec - время звукового импульса нажатия кнопки
                                 .equ led_light_time = 620 ;= 500 msec - время светового импульса
                                 .equ time_wait = 4960 ;= 4000 msec - время ожидания вкл/откл БП
                                 .equ key_wait = 50 ;= 40 msec - время дребезга кнопки
                                 .INCLUDE "var-offonctrl.inc"
                                 
                                  * var_offonctrl.asm
                                  *
                                  *  Created: 30.10.2019 13:48:31
                                  *   Author: vp
                                  */ 
                                 ;====================================================================
                                 ;                       VARIABLES
                                 ;====================================================================
                                 .DSEG
                                 .ORG 0x60
                                 ;fdel:       .byte 1 ; 1 - флаг четного прерывания или делителя частоты: 0 - четный (пропуск счета); 1 - нечетный (счет)
                                 ;==============================================================================================
                                 ;                  таймер номер 1 (например для звука)
                                 ;.ORG 0x61
000060                           timer01:  .byte 3	; +0 - флаг таймера: 0 - неактивный; 1- активный
                                 				    ; +1 - время работы таймера (мл. байт слова)
                                 				    ; +2 - время работы таймера (ст. байт слова)
                                 ;==============================================================================================
                                 ;                  таймер номер 2 (например для мигания светодиода)
                                 ;.ORG 0x64
000063                           timer02:.byte 3	; +0 - флаг таймера: 0 - неактивный; 1- активный
                                 				    ; +1 - время работы таймера (мл. байт слова)
                                 				    ; +2 - время работы таймера (ст. байт слова)
                                 ;==============================================================================================
                                 ;                  таймер номер 3 (например для ожидания события)
                                 ;.ORG 0x67
000066                           timer03: .byte 3	; +0 - флаг таймера: 0 - неактивный; 1- активный
                                 				    ; +1 - время работы таймера (мл. байт слова)
                                 				    ; +2 - время работы таймера (ст. байт слова)
                                 ;==============================================================================================
                                 ;                  таймер номер Z (например для дребезга кнопки)
                                 ;.ORG 0x?? - последняя запись структур таймера. Добавление записей таймеров должно осуществляться до этой записи
000069                           timer0Z:  .byte 3   ; +0 - флаг таймера: 0 - неактивный; 1- активный
                                                     ; +1 - время работы таймера (мл. байт слова)
                                                     ; +2 - время работы таймера (ст. байт слова)
                                 ;==============================================================================================
                                 ;                               Состояния и режимы
                                 ;==============================================================================================
                                 ;====================================================================
                                 ; state |                       0 - отключен                        |
                                 ;====================================================================
                                 ; mode  | Готовность | Ожидание включения | Индикация неисправности |
                                 ;       |  Ожидание  | (появление напряже-| (БП не запустился или   |
                                 ;       |  кнопки    |  ния)              | самопроизвольно отключ. |
                                 ;       |============================================================
                                 ;       |     0      |         1          |          2              |
                                 ;====================================================================
                                 ; state |                       1 - включен                         |
                                 ;====================================================================
                                 ; mode  | Готовность | Ожидание отключения| Индикация неисправности |
                                 ;       | Ожидание   |(пропадание напряже-| (БП не отключился)      |
                                 ;       | кнопки     | ния)               |                         |
                                 ;       |============================================================
                                 ;       |    0       |         1          |          2              |
                                 ;====================================================================
                                 ;state:    .byte 1    ; состояние: 0 - отключен; 1 - включен
                                 ;mode:     .byte 1    ; режим состояния
                                 ;button:   .byte 1    ; событие нажатия кнопки: 0 - нет события; 1 - была нажата и отжата.
                                 ;key_state:.byte 1    ; состояние обработчика нажатия кнопки: 
                                 ;                     ;     0 - ожидание: начальное значение - устанавл. обработчик key_process
                                 ;                     ;     1 - событие обработчика прерывания - произошло изменение входа INT0 - начало обработки дребезга контактов
                                 ;                     ;     2 - событие обработчика прерывания - обработка дребезга контактов и определение состояния кнопки
                                 ;                     ;         устанавл. обработчик key_process
                                 ;pwr_ok_event:.byte 1 ; событие изменения состояния контрольного сигнала PW_OK
                                 ;                     ;     0 - ожидание: нет события;
                                 ;                     ;     1 - событие - состояние изменилось
                                 ;pwr_ok_state:.byte 1    ; состояние входа контрольного сигнала PW_OK
                                                      ;     0 - нет напряжения;
                                                      ;     1 - есть напряжение
                                 ;snd_err_stat:.byte 1 ; звуковое статус: 0 - звучание; 1 - пауза.
                                 ;snd_err_mode:.byte 1 ; звуковой режим: 0 - отключен; 1 - БП не включился; 2 - БП самопроизвольно отключился
                                 ;==============================================================================================
                                 ;                                   Код ошибки
                                 ;==============================================================================================
                                 ; Коды ошибок:
                                 ; 0 - нет ошибки; 
                                 ; 1 - БП не запустился; 
                                 ; 2 - БП - не отключился; 
                                 ; 3 - БП самопроизвольно отключился
                                 ;==============================================================================================
                                 ;error:    .byte 1 
                                 .ifdef _DEBUG_
                                 .endif
                                 
                                 .CSEG              
                                 .ORG 0
                                 ;===========================================================================================
                                 ;                           Сброс и векторы прерываний
                                 ;===========================================================================================
000000 c065                      	rjmp start
000001 c172                      	rjmp _int0
000002 c17f                      	rjmp pcint
000003 c149                      	rjmp tim_ovo
000004 c18b                      	rjmp ee_rdy
000005 c18a                      	rjmp ana_comp
000006 c189                      	rjmp tim_compa
000007 c188                      	rjmp tim_compb
000008 c187                      	rjmp watch_dog
000009 c186                      	rjmp ADConv
                                 
                                 
                                 .INCLUDE "calls.asm"
                                 
                                  * calls.asm
                                  *
                                  *  Created: 30.10.2019 17:00:56
                                  *   Author: vp
                                  */ 
                                 .CSEG              
                                 
                                     ;=====================================================
                                     ;           ПП обработки нажатия кнопки 
                                     ; (состояние и дребезг совместно с обработчиком int0)
                                     ;=====================================================
                                 key_process:
00000a 1447                          cp key_state, const_0
00000b f0d1                          breq key_process_return ; нет события
                                     ; есть событие
00000c 1449                          cp key_state, const_2
00000d f031                          breq key_process_ready  ; key_state == 2 - проверка таймера дребезга
                                     ; key_state == 1
                                     ; запуск таймера дребезга
00000e 9443                          inc key_state    ; key_state = 2
00000f e6a9                          ldi XL, LOW(timer0Z)  
000010 e302                          ldi temp1, LOW(key_wait) 
000011 e010                          ldi temp2, HIGH(key_wait)
000012 d044                          rcall _set_timer_proc_
000013 c012                          rjmp key_process_return
                                 key_process_ready:
                                     ; key_state == 2
                                     ; проверка таймера дребезга
000014 9100 0069                     lds temp1, timer0Z
000016 3000                          cpi temp1, 0
000017 f471                          brne key_process_return
                                     ; проверка порта PB1
000018 b316                          in temp2, pinB
000019 e022                          ldi temp3, 0x02
00001a 2312                          and temp2, temp3
00001b 9516                          lsr temp2
00001c 2ea1                          mov button_state, temp2
                                 .ifdef _DEBUG_
                                  .endif
00001d 2444                          clr key_state   ; key_state = 0
00001e 2c38                          mov button_event, const_1
00001f e400
000020 b71b
000021 2b10
000022 bf1b
000023 b71a
000024 2710
000025 bf1a                          _EN_EXTINT_ temp1, temp2, 0x40  ; 0x40 - бит прерывания от INT0
                                 key_process_return:
000026 9508                          ret
                                 
                                     ;==============================================================
                                     ; ПП контроля сигнала PW_OK определяющего рабочее состоние БП 
                                     ; (состояние совместно с обработчиком tim_ovo pcint)
                                     ;==============================================================
                                 pwr_ctrl_process:
                                     ; проверка события
000027 1457                          cp pwr_ok_event, const_0                ; в общем 1 - изменение состояния входа
000028 f099                          breq pwr_ctrl_process_return    ; --> pwr_ok_event == 0 - события нет, завершение
                                     ; pwr_ok_event != 0 - событие произошло
000029 1459                          cp pwr_ok_event, const_2
00002a f031                          breq pwr_ctrl_process_ready  ; pwr_ok_event == 2 - проверка таймера дребезга
                                     ; pwr_ok_event == 1
                                     ; запуск таймера дребезга
00002b 9453                          inc pwr_ok_event    ; pwr_ok_event = 2
00002c e6a9                          ldi XL, LOW(timer0Z)  
00002d e302                          ldi temp1, LOW(key_wait) 
00002e e010                          ldi temp2, HIGH(key_wait)
00002f d027                          rcall _set_timer_proc_
000030 c00b                          rjmp pwr_ctrl_process_return
                                 pwr_ctrl_process_ready:
                                     ; pwr_ok_event == 2
                                     ; проверка таймера дребезга
000031 9100 0069                     lds temp1, timer0Z
000033 3000                          cpi temp1, 0
000034 f439                          brne pwr_ctrl_process_return
                                     ; проверка состояния входа PB2 контроля сигнала PW_OK
000035 b316                          in temp2, pinB
000036 e024                          ldi temp3, 0x04
000037 2312                          and temp2, temp3
000038 9516                          lsr temp2
000039 9516                          lsr temp2
00003a 2e61                          mov pwr_ok_state, temp2
                                 .ifdef _DEBUG_
                                  .endif
00003b 2455                          clr pwr_ok_event   ; pwr_ok_event = 0
                                 pwr_ctrl_process_return:
00003c e200
00003d b71b
00003e 2b10
00003f bf1b
000040 b71a
000041 2710
000042 bf1a                          _EN_EXTINT_ temp1, temp2, 0x20  ; 0x20 - бит прерывания от PCIE
000043 9508                          ret
                                 
                                     ;=====================================================
                                     ;           ПП включение ошибки БП 
                                     ;=====================================================
                                 set_power_error:
                                     ; БП не включился - сбой включения
000044 b50f
000045 e410
000046 2b01
000047 bd0f                      	_OCR0A_On_ temp1, temp2    ; включить звук сбоя оборудования
000048 e6a0                          ldi XL, LOW(timer01)
000049 ed08                          ldi temp1, LOW(err_snd_time) 
00004a e014                          ldi temp2, HIGH(err_snd_time)
00004b e021                          ldi temp3, 1
00004c d00a                          rcall _set_timer_proc_
00004d 9508                          ret
                                  
                                     ;=====================================================
                                     ;  ПП включение таймеров звука и ожидания события 
                                     ;=====================================================
                                 set_sound_wait_timers:
                                     ; запуск таймера звука
00004e e6a0                          ldi XL, LOW(timer01)  
00004f e70c                          ldi temp1, LOW(key_snd_time) 
000050 e010                          ldi temp2, HIGH(key_snd_time)
000051 d005                          rcall _set_timer_proc_
                                     ; запуск таймера ожидания включения/отключения БП
000052 e6a6                          ldi XL, LOW(timer03)  
000053 e600                          ldi temp1, LOW (time_wait) 
000054 e113                          ldi temp2, HIGH(time_wait)
000055 d001                          rcall _set_timer_proc_
000056 9508                          ret
                                 
                                     ;=====================================================
                                     ;          ПП   инициализации таймеров
                                     ;=====================================================
                                 _set_timer_proc_:
000057 2322                          tst temp3
000058 f431                          brne _set_timer_start
                                     ;=====================================================
                                     ;   иницирование нового таймера со сбросом старого 
                                     ;=====================================================
000059 94f8                          cli
00005a 932d                          st X+, temp3    ; обнулить флаг таймера - запрет немедленного выполнения таймера
00005b 930d                          st X+, temp1    ; инициализировать мл. байт значения таймера
00005c 931c                          st X,  temp2    ; инициализировать ст. байт значения таймера
00005d 9478                          sei
00005e c006                          rjmp _set_timer_return
                                     ;=====================================================
                                     ;           иницирование нового таймера 
                                     ;        вместо уже отработавшего старого 
                                     ;=====================================================
                                 _set_timer_start:
00005f 9613                          adiw X, 3
000060 94f8                          cli
000061 931e                          st -X, temp2    ; инициализировать ст. байт значения таймера 
000062 930e                          st -X, temp1    ; инициализировать мл. байт значения таймера 
000063 932e                          st -X, temp3    ; установить флаг таймера - немедленный запуск таймера с новыми параметрами
000064 9478                          sei
                                 _set_timer_return:
000065 9508                          ret
                                 
                                 
                                 ;===========================================================================================
                                 ;                            Инициализация программы
                                 ;===========================================================================================
                                 start:
000066 e90f                      	ldi temp1, low(RAMEND)
000067 bf0d                      	out SPL, temp1
                                     ;=====================================================
                                 	;           настройка портов ввода/вывода
                                     ;=====================================================
000068 e109                      	ldi temp1, 0x19   ; b00011001
000069 bb07                          out ddrB, temp1	; B1,B2,B5 - входы, B0,B3,B4 - выходы
00006a e10a                      	ldi temp1, 0x1A	; b00011010 B1 с подтяжкой,B2,B5-без;B0=0,B3,B4==1
00006b bb08                      	out portB, temp1
                                     ;=====================================================
                                 	;     настройка предделителя тактового генератора
                                     ;=====================================================
                                 .ifdef _DEBUG_
                                 .endif
00006c e800                      	ldi temp1, 0x80
00006d e011                      	ldi temp2, 0x01   ; Кдел предделителя тактового генератора = 2
00006e bd06                      	out clkpr, temp1
00006f bd16                      	out clkpr, temp2
                                 .ifdef _DEBUG_
                                 .endif
                                     ;=====================================================
                                     ;               настройка таймера
                                     ;=====================================================
000070 2700                      	clr temp1
000071 bf09                      	out timsk0, temp1	; прерывания от таймера T0 запрещены
000072 bd0f                      	out tccr0a, temp1	; режим T0 - normal, OCR0A и OCR0B отключены от выводов 
000073 ef0f                      	ldi temp1, 0xff	;
000074 bf06                      	out ocr0a, temp1
000075 e002                      	ldi temp1, 0x02   ; Кдел предделителя T0 = 8
000076 bf03                      	out tccr0b, temp1	
                                     ;=====================================================
                                     ;               инициализация памяти
                                     ;=====================================================
000077 2400                          clr fdel    ; сброс программного делителя частоты прерывания TCNT0
000078 2411                          clr state   ; установка нулевого состояния - БП отключен
000079 2422                          clr mode    ; установка режима ожидания нажатия кнопки для включения БП
00007a b2a6                          in button_state, pinB  ; установка состояния нажатия кнопки
00007b e002                          ldi temp1, 0x02
00007c 22a0                          and button_state, temp1
00007d 94a6                          lsr button_state
00007e 2433                          clr button_event  ; сброс состояния обработчика контроля напряжения
00007f 2444                          clr key_state  ; сброс состояния обработчика нажатия кнопки
                                     ;clr pwr_ok_state  ; сброс состояния входа контроля напряжения
000080 b266                          in pwr_ok_state, pinB  ; установка состояния входа контроля напряжения
000081 e004                          ldi temp1, 0x04
000082 2260                          and pwr_ok_state, temp1
000083 9466                          lsr pwr_ok_state
000084 9466                          lsr pwr_ok_state
000085 2455                          clr pwr_ok_event  ; сброс состояния обработчика контроля напряжения
000086 2488                          clr const_1;
000087 e021                          ldi temp3, 1
000088 2e82                          mov const_1, temp3
000089 e022                          ldi temp3, 2
00008a 2e92                          mov const_2, temp3
                                 .ifdef _DEBUG_
                                 .endif
                                     ;=====================================================
                                     ;           инициализация таймеров: отключение
                                     ;=====================================================
00008b 2722                           clr temp3
00008c 9320 0060                      sts timer01, temp3
00008e 9320 0063                      sts timer02, temp3
000090 9320 0066                      sts timer03, temp3
000092 9320 0069                      sts timer0Z, temp3
                                     ;=====================================================
                                     ;       задается прерывание переполнения TCNT0
                                     ;=====================================================
000094 e002                          ldi temp1, 0x02       ; 0x02 - бит прерывания от переполнения TCNT0
000095 b719                          in temp2, timsk0
000096 2b10                          or temp2, temp1
000097 bf19                          out timsk0, temp2     ; устанавливается разрешение прерывания от переполнения TCNT0
                                     ;=====================================================
                                     ;   задается номер прерывания PCINT2
                                     ;=====================================================
000098 e004
000099 b315
00009a 2b10
00009b bb15                          _SET_NUM_PCIE_ temp1, temp2, 0x04   ; 0x04 - задается номер прерывания PCINT2
                                     ;=====================================================
                                     ; задается режим внешнего прерывания INT0 
                                     ; 0 - по низкому уровню
                                     ; 1 - при любом изменении 
                                     ; 2 - по спаду
                                     ; 3 - по фронту
                                     ;=====================================================
00009c e001
00009d b715
00009e 2b10
00009f bf15                          _MODE_INT0_ temp1, temp2, 1   
                                     ;=========================================================
                                     ; задается разрешение от внешнего прерывания INT0 и PCIE
                                     ;=========================================================
0000a0 e600
0000a1 b71b
0000a2 2b10
0000a3 bf1b
0000a4 b71a
0000a5 2710
0000a6 bf1a                          _EN_EXTINT_ temp1, temp2, 0x60  ; 0x40 - бит прерывания от INT0 + 0x20 - бит прерывания от PCIE
                                     ;=====================================================
                                     ;       Сброс флагов прерываний от таймера
                                     ;=====================================================
0000a7 2700                          clr temp1
0000a8 bf08                          out tifr0, temp1
0000a9 9478                          sei
                                 ;===========================================================================================
                                 ;                            Основная программа
                                 ;===========================================================================================
                                 main_loop:
                                     ;=====================================================
                                     ;              Определение состояния системы
                                     ;=====================================================
0000aa 1418                          cp state, const_1
0000ab f011                          breq main_loop_state1
0000ac d004                          rcall main_state0
0000ad c001                          rjmp main_loop_continue
                                 
                                 main_loop_state1:
0000ae d040                          rcall main_state1
                                 
                                 main_loop_continue:    
0000af d077                          rcall main_loop_indication
0000b0 cff9                          rjmp main_loop
                                 
                                 ;===========================================================================================
                                 ;                           Определение попдпрограмм
                                 ;===========================================================================================
                                     ;=====================================================
                                     ;          ПП   Обработка состояния 0 - "Отключен"
                                     ;=====================================================
                                 main_state0:
0000b1 1428                          cp mode, const_1
0000b2 f011                          breq main_loop_state0_mode1
0000b3 d003                          rcall main_state0_mode0
0000b4 c001                          rjmp main_state0_return
                                 
                                 main_loop_state0_mode1:
0000b5 d01f                          rcall main_state0_mode1
                                 
                                 main_state0_return:
0000b6 9508                          ret
                                 
                                     ;=====================================================
                                     ;          ПП   Обработка состояния 0 - режим 0
                                     ;=====================================================
                                 main_state0_mode0:
0000b7 df6f                          rcall  pwr_ctrl_process  ; вызов пп контроля сигнала PW_OK
0000b8 1468                          cp pwr_ok_state, const_1
0000b9 f0d1                          breq main_state0_mode0_return  ; если 1 - неисправность МК
0000ba df4f                          rcall key_process   ; вызов обработчика события от кнопки
0000bb 1438                          cp button_event, const_1
0000bc f4b9                          brne main_state0_mode0_return  ; если 0
0000bd 2433                          clr button_event ; сброс события от кнопки
0000be 14a8                          cp button_state, const_1  ; проверка состояния кнопки
0000bf f051                          breq main_state0_mode0_set_mode1  ; если 1 - Включение БП
                                     ; если 0
                                     ;=====================================================
                                     ; Кнопка была нажата. Выдача звукового сигнала
                                     ;=====================================================
0000c0 e021                          ldi temp3, 1    ; запустить таймер сразу после инициализации
                                     ; запуск таймера звука - звуковое подтверждение нажатия кнопки
0000c1 e6a0                          ldi XL, LOW(timer01)  
0000c2 e70c                          ldi temp1, LOW(key_snd_time) 
0000c3 e010                          ldi temp2, HIGH(key_snd_time)
0000c4 df92                          rcall _set_timer_proc_
0000c5 b50f
0000c6 e410
0000c7 2b01
0000c8 bd0f                          _OCR0A_On_ temp1, temp2 ; включить звук - звуковое подтверждение нажатия кнопки
0000c9 c00a                          rjmp main_state0_mode0_return  ; 
                                 main_state0_mode0_set_mode1:   
                                     ;Включение БП
                                     ;=====================================================
                                     ; Кнопка была отпущена. Переход в режим 1
                                     ;=====================================================
0000ca b306                          in temp1, PinB
0000cb ef17                          ldi temp2, 0xf7
0000cc 2301                          and temp1, temp2
0000cd bb08                          out portB, temp1  ; установить в 0 сигнал PS_ON БП
                                     ; установить режим 1 состояния 0
0000ce 9423                          inc mode
                                     ; запуск таймера ожидания включения/отключения БП
0000cf e021                          ldi temp3, 1    ; запустить таймер сразу после инициализации
0000d0 e6a6                          ldi XL, LOW(timer03)  
0000d1 e600                          ldi temp1, LOW (time_wait) 
0000d2 e113                          ldi temp2, HIGH(time_wait)
0000d3 df83                          rcall _set_timer_proc_
                                 main_state0_mode0_return:
0000d4 9508                          ret
                                 
                                     ;=====================================================
                                     ;          ПП   Обработка состояния 0 - режим 1
                                     ;=====================================================
                                 main_state0_mode1:
0000d5 df51                          rcall  pwr_ctrl_process  ; вызов пп контроля сигнала PW_OK
                                     ; проверка включения БП
0000d6 1468                          cp pwr_ok_state, const_1                          ; 1 - сигнал PW_OK присутствует
0000d7 f461                          brne  main_state0_mode1_off         ; 0 - отсутствует
                                 main_state0_mode1_on:
                                     ; БП включился
                                     ; установка режима 0 состояния 1
0000d8 2422                          clr mode   ; установить режим 0 состояния 1
0000d9 9413                          inc state  ; установить состояние 1
                                     ; управление светодиодом индикации включения/отключения БП
0000da ee0f                          ldi temp1, 0xef
0000db b316                          in temp2, pinB
0000dc 2310                          and temp2, temp1
0000dd bb18                          out portB, temp2  ; включить светодиод
0000de e020                          ldi temp3, 0
0000df 9320 0063                     sts timer02, temp3 ; отключить таймер мигания светодиода 
0000e1 9320 0066                     sts timer03, temp3 ; отключить таймер ожидания включения
0000e3 c00a                          rjmp main_state0_mode1_return
                                 main_state0_mode1_off:
                                     ; ожидание включения БП
0000e4 9100 0066                     lds temp1, timer03
0000e6 3000                          cpi temp1, 0
0000e7 f431                          brne main_state0_mode1_return
                                     ; БП не включился - сбой включения
0000e8 2422                          clr mode   ; установить режим 0 состояния 0
0000e9 b306                          in temp1, PinB
0000ea e018                          ldi temp2, 0x08
0000eb 2b01                          or temp1, temp2
0000ec bb08                          out portB, temp1  ; установить в 1 сигнал PS_ON БП
0000ed df56                          rcall set_power_error
                                 main_state0_mode1_return:
0000ee 9508                          ret
                                 
                                 ;==============================================================================
                                 
                                     ;=====================================================
                                     ;          ПП   Обработка состояния 1 - "Включен"
                                     ;=====================================================
                                 main_state1:
0000ef 1428                          cp mode, const_1
0000f0 f011                          breq main_loop_state1_mode1
0000f1 d003                          rcall main_state1_mode0
0000f2 c001                          rjmp main_state1_return
                                 
                                 main_loop_state1_mode1:
0000f3 d022                          rcall main_state1_mode1
                                 
                                 main_state1_return:
0000f4 9508                          ret
                                 
                                     ;=====================================================
                                     ;          ПП   Обработка состояния 1 - режим 0
                                     ;=====================================================
                                 main_state1_mode0:
0000f5 df31                          rcall  pwr_ctrl_process  ; вызов пп контроля сигнала PW_OK
                                     ; проверка работы БП
0000f6 1468                          cp pwr_ok_state, const_1                          ; 1 - сигнал PW_OK присутствует
0000f7 f4d9                          brne  main_state1_mode0_off         ; 0 - отсутствует
0000f8 df11                          rcall key_process   ; вызов обработчика события от кнопки
0000f9 1438                          cp button_event, const_1
0000fa f4d1                          brne main_state1_mode0_return  ; если 0
0000fb 2433                          clr button_event ; сброс события от кнопки
0000fc 14a8                          cp button_state, const_1  ; проверка состояния кнопки
0000fd f051                          breq main_state1_mode0_set_mode1  ; если 1 - Включение БП
                                     ; если 0
                                     ;=====================================================
                                     ; Кнопка была нажата. Выдача звукового сигнала
                                     ;=====================================================
0000fe e021                          ldi temp3, 1    ; запустить таймер сразу после инициализации
                                     ; запуск таймера звука - звуковое подтверждение нажатия кнопки
0000ff e6a0                          ldi XL, LOW(timer01)  
000100 e70c                          ldi temp1, LOW(key_snd_time) 
000101 e010                          ldi temp2, HIGH(key_snd_time)
000102 df54                          rcall _set_timer_proc_
000103 b50f
000104 e410
000105 2b01
000106 bd0f                          _OCR0A_On_ temp1, temp2 ; включить звук - звуковое подтверждение нажатия кнопки
000107 c00d                          rjmp main_state1_mode0_return  ; 
                                 main_state1_mode0_set_mode1:
                                     ;Отключение БП
                                     ;=====================================================
                                     ; Кнопка была отпущена. Переход в режим 1
                                     ;=====================================================
000108 b306                          in temp1, PinB
000109 e018                          ldi temp2, 0x08
00010a 2b01                          or temp1, temp2
00010b bb08                          out portB, temp1  ; установить в 1 сигнал PS_ON БП
                                     ; установить режим 1 состояния 1
00010c 9423                          inc mode
                                     ; запуск таймера ожидания включения/отключения БП
00010d e021                          ldi temp3, 1    ; запустить таймер сразу после инициализации
00010e e6a6                          ldi XL, LOW(timer03)  
00010f e600                          ldi temp1, LOW (time_wait) 
000110 e113                          ldi temp2, HIGH(time_wait)
000111 df45                          rcall _set_timer_proc_
000112 c002                          rjmp main_state1_mode0_return
                                 main_state1_mode0_off:
                                     ; БП самопроизвольно отключился
000113 df30                          rcall set_power_error
000114 cff3                          rjmp main_state1_mode0_set_mode1
                                 main_state1_mode0_return:
000115 9508                          ret
                                 
                                     ;=====================================================
                                     ;          ПП   Обработка состояния 1 - режим 1
                                     ;=====================================================
                                 main_state1_mode1:
000116 df10                          rcall  pwr_ctrl_process  ; вызов пп контроля сигнала PW_OK
                                     ; проверка отключения БП
000117 1467                          cp pwr_ok_state, const_0                          ; 0 - сигнал PW_OK отсутствует
000118 f439                          brne  main_state1_mode1_on          ; 1 - присутствует
                                 main_state1_mode1_off:
                                     ; БП отключился
                                     ; установка режима 0 состояния 0
000119 2422                          clr mode   ; установить режим 0 состояния 0
00011a 2411                          clr state  ; установить состояние 0
                                     ; управление светодиодом индикации включения/отключения БП
00011b e100                          ldi temp1, 0x10 ;0xef
00011c b316                          in temp2, pinB
00011d 2b10                          or temp2, temp1
00011e bb18                          out portB, temp2  ; отключить светодиод
00011f c006                          rjmp main_state1_mode1_return
                                 main_state1_mode1_on:
                                     ; ожидание отключения БП
000120 9100 0066                     lds temp1, timer03
000122 3000                          cpi temp1, 0
000123 f411                          brne main_state1_mode1_return
                                     ; БП не отключился - сбой отключения
000124 df1f                          rcall set_power_error
000125 cff3                          rjmp main_state1_mode1_off
                                 main_state1_mode1_return:
000126 9508                          ret
                                 
                                 ;==============================================================================
                                 
                                     ;=====================================================
                                     ;                ПП  Модель индикации
                                     ;=====================================================
                                 main_loop_indication:
000127 9100 0060                     lds temp1, timer01
000129 2300                          tst temp1
00012a f421                          brne main_loop_indication_continue
00012b b50f
00012c eb1f
00012d 2301
00012e bd0f                      	_OCR0A_Off_ temp1, temp2    ; отключить звук
                                 main_loop_indication_continue:
00012f 1417                          cp state, const_0
000130 f4d9                          brne main_loop_indication_return
                                     ; индикация нулевого состояния сетодиодом
000131 9100 0063                     lds temp1, timer02
000133 2300                          tst temp1
000134 f4b9                          brne main_loop_indication_return
                                     ; управление светодиодом индикации включения/отключения БП
000135 e6a3                          ldi XL, LOW(timer02)
000136 e60c                          ldi temp1, LOW(led_light_time)
000137 e012                          ldi temp2, HIGH(led_light_time)
000138 e021                          ldi temp3, 1
000139 df1d                          rcall _set_timer_proc_
00013a e100                          ldi temp1, 0x10
00013b b316                          in temp2, pinB
00013c 2710                          eor temp2, temp1
00013d bb18                          out portB, temp2
                                     ; индикация неисправности: случай неотключения БП
00013e 1468                          cp pwr_ok_state, const_1
00013f f461                          brne main_loop_indication_return
000140 2310                          and temp2, temp1
000141 3110                          cpi temp2, 0x10
000142 f449                          brne main_loop_indication_return
000143 e6a0                          ldi XL, LOW(timer01)
000144 e60c                          ldi temp1, LOW(led_light_time)
000145 e012                          ldi temp2, HIGH(led_light_time)
000146 e021                          ldi temp3, 1
000147 df0f                          rcall _set_timer_proc_
000148 b50f
000149 e410
00014a 2b01
00014b bd0f                      	_OCR0A_On_ temp1, temp2    ; включить звук
                                   
                                 main_loop_indication_return:
00014c 9508                          ret
                                 
                                 ;===========================================================================================
                                 ;                            Обработчики прерываний
                                 ;===========================================================================================
                                 tim_ovo: 
                                 ;=========================================================
                                 ;     Прерывание от переполнения таймера T0
                                 ;   прерывание реализует логику программных таймеров
                                 ;=========================================================
                                     ; Сохранение регистров в стеке
00014d 930f                          push temp1
00014e b70f                          in temp1, sreg
00014f 930f                          push temp1
000150 93cf                          push YL
000151 93df                          push YH
000152 93af                          push XL
000153 938f                          push r24
000154 939f                          push r25
                                     ;=====================================================
                                     ;               делитель частоты на 2
                                     ;=====================================================
000155 e6c0                          ldi YL, low(timer01)   ; указать адрес на первый таймер
000156 27dd                          clr YH
000157 2000                          tst fdel      ; проверка четности цикла
000158 f081                          breq tim_ovo_return   ; если 0 - пропуск счета, цикл четный
                                     ;=====================================================
                                     ;           Цикл проверки и работы всех таймеров
                                     ;=====================================================
000159 e6a9                          ldi XL, LOW( timer0Z)   ; загрузить мл. байт адреса структуры timer0Z - последняя запись таймеров
00015a 95a3                          inc XL  ; +1 для того чтобы сделать XL заведомо больше адреса timer0Z и операцию brlt не дополнять операцией breq
                                 tim_ovo_repeat:
00015b 8188                          ld r24, Y   ; загрузить состояние текущего таймера
00015c 2388                          tst r24
00015d f041                          breq tim_ovo_next ; если 0 - текущий таймер не включен
00015e 8189                          ldd r24, Y+1    ; загрузка значение текущего таймера - мл. байт
00015f 819a                          ldd r25, Y+2    ; загрузка значение текущего таймера - ст. байт
000160 9701                          sbiw r24, 1     ; уменьшение значения текущего таймера
000161 8389                          std Y+1, r24    ; сохранение значения текущего таймера - мл. байт
000162 839a                          std Y+2, r25    ; сохранение значения текущего таймера - ст. байт
000163 2b89                          or r24, r25     ; проверка на 0
000164 f409                          brne tim_ovo_next
000165 8388                          st Y, r24       ; сбросить состояние текущего таймера в 0 (не активный)
                                 tim_ovo_next:
000166 9623                          adiw Y, 3   ; установить адрес на следующую структуру таймера
000167 17ca                          cp YL, XL   ; проверить на конец таблицы таймеров. здесь XL > адреса timer0Z на 1 (timer0Z - последняя структура таймеров) 
000168 f394                          brlt tim_ovo_repeat   ; если это не конец, то перейти к следующей записи.
                                     ;breq tim_ovo_repeat
                                     ;=====================================================
                                     ;           Завешение обработки прерывания
                                     ;=====================================================
                                 tim_ovo_return:
000169 e091                          ldi r25, 1
00016a 2609                          eor fdel, r25
                                     ; восстановление регистров из стека
00016b 919f                          pop r25
00016c 918f                          pop r24
00016d 91af                          pop XL
00016e 91df                          pop YH
00016f 91cf                          pop YL
000170 910f                          pop temp1
000171 bf0f                          out sreg, temp1
000172 910f                          pop temp1
                                     
000173 9518                      	reti
                                 
                                 
                                 _int0: 
                                 ;=========================================================
                                 ;  Прерывание по INT0 - обработка события от кнопки
                                 ;        Включение или отключение устройства
                                 ;=========================================================
                                     ; Сохранение регистров в стеке
000174 930f                          push temp1
000175 b70f                          in temp1, sreg
000176 930f                          push temp1
000177 931f                          push temp2
                                 
                                     ;=========================================================
                                     ;     key_state - состояние обработчика нажатия кнопки
                                     ;     0 - ожидание - начальное значение - уст. обработчик key_process;
                                     ;     1 - произошло изменение состояния входа INT0 - уст. здесь
                                     ;     2 - обработка дребезга котактов - уст. обработчик key_process;
                                     ;=========================================================
000178 9443                          inc key_state
                                     ;=========================================================
                                     ;       задается запрет от внешнего прерывания INT0
                                     ;=========================================================
                                 ;_int0_disable_:
000179 e400
00017a b71b
00017b 2710
00017c bf1b                          _DIS_EXTINT_ temp1, temp2, 0x40  ; 0x40 - бит прерывания от INT0
                                     ; восстановление регистров из стека
00017d 911f                          pop temp2
00017e 910f                          pop temp1
00017f bf0f                          out sreg, temp1
000180 910f                          pop temp1
                                     
000181 9518                      	reti
                                 
                                 pcint: 
                                 ;=========================================================
                                 ;         Прерывание по PCIE2 - обработка любого 
                                 ;             изменения состояния входа B2
                                 ;       Слежение за контрольным сигналом устройства
                                 ;=========================================================
                                     ; Сохранение регистров в стеке
000182 930f                          push temp1
000183 b70f                          in temp1, sreg
000184 930f                          push temp1
000185 931f                          push temp2
                                    
                                     ; Пока считаю, что от напряжения питания дребезга нет, т.к. на нем емкостная нагрузка
000186 9453                          inc pwr_ok_event
                                     ;=========================================================
                                     ;       задается запрет от внешнего прерывания PCIE2
                                     ;=========================================================
                                 ;_pcint_disable_:
000187 e200
000188 b71b
000189 2710
00018a bf1b                          _DIS_EXTINT_ temp1, temp2, 0x20  ; 0x20 - бит прерывания от PCIE
                                 
                                     ; восстановление регистров из стека
00018b 911f                          pop temp2
00018c 910f                          pop temp1
00018d bf0f                          out sreg, temp1
00018e 910f                          pop temp1
                                     
00018f 9518                      	reti
                                 
                                 ee_rdy: 
                                 ana_comp:
                                 tim_compa: 
                                 tim_compb: 
                                 watch_dog: 
                                 ADConv: 


RESOURCE USE INFORMATION
------------------------

Notice:
The register and instruction counts are symbol table hit counts,
and hence implicitly used resources are not counted, eg, the
'lpm' instruction without operands implicitly uses r0 and z,
none of which are counted.

x,y,z are separate entities in the symbol table and are
counted separately from r26..r31 here.

.dseg memory usage only counts static data declared with .byte

"ATtiny13A" register use summary:
x  :   7 y  :   7 z  :   0 r0 :   3 r1 :   5 r2 :   8 r3 :   6 r4 :   6 
r5 :   6 r6 :  10 r7 :   4 r8 :  14 r9 :   3 r10:   6 r11:   0 r12:   0 
r13:   0 r14:   0 r15:   0 r16: 114 r17:  88 r18:  26 r19:   0 r20:   0 
r21:   0 r22:   0 r23:   0 r24:   9 r25:   7 r26:  16 r27:   0 r28:   4 
r29:   3 r30:   0 r31:   0 
Registers used: 21 out of 35 (60.0%)

"ATtiny13A" instruction use summary:
.lds  :   0 .sts  :   0 adc   :   0 add   :   0 adiw  :   2 and   :   8 
andi  :   0 asr   :   0 bclr  :   0 bld   :   0 brbc  :   0 brbs  :   0 
brcc  :   0 brcs  :   0 break :   0 breq  :  12 brge  :   0 brhc  :   0 
brhs  :   0 brid  :   0 brie  :   0 brlo  :   0 brlt  :   1 brmi  :   0 
brne  :  16 brpl  :   0 brsh  :   0 brtc  :   0 brts  :   0 brvc  :   0 
brvs  :   0 bset  :   0 bst   :   0 cbi   :   0 cbr   :   0 clc   :   0 
clh   :   0 cli   :   2 cln   :   0 clr   :  19 cls   :   0 clt   :   0 
clv   :   0 clz   :   0 com   :   0 cp    :  18 cpc   :   0 cpi   :   5 
cpse  :   0 dec   :   0 eor   :   7 icall :   0 ijmp  :   0 in    :  29 
inc   :   8 ld    :   1 ldd   :   2 ldi   :  76 lds   :   6 lpm   :   0 
lsl   :   0 lsr   :   6 mov   :   5 movw  :   0 neg   :   0 nop   :   0 
or    :  14 ori   :   0 out   :  35 pop   :  13 push  :  13 rcall :  27 
ret   :  12 reti  :   4 rjmp  :  24 rol   :   0 ror   :   0 sbc   :   0 
sbci  :   0 sbi   :   0 sbic  :   0 sbis  :   0 sbiw  :   1 sbr   :   0 
sbrc  :   0 sbrs  :   0 sec   :   0 seh   :   0 sei   :   3 sen   :   0 
ser   :   0 ses   :   0 set   :   0 sev   :   0 sez   :   0 sleep :   0 
spm   :   0 st    :   7 std   :   2 sts   :   6 sub   :   0 subi  :   0 
swap  :   0 tst   :   5 wdr   :   0 
Instructions used: 32 out of 105 (30.5%)

"ATtiny13A" memory use summary [bytes]:
Segment   Begin    End      Code   Data   Used    Size   Use%
---------------------------------------------------------------
[.cseg] 0x000000 0x000322    802      0    802    1024  78.3%
[.dseg] 0x000060 0x00006c      0     12     12      64  18.8%
[.eseg] 0x000000 0x000000      0      0      0      64   0.0%

Assembly complete, 0 errors, 0 warnings
